(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{447:function(e,a,s){"use strict";s.r(a);var i=s(17),l=Object(i.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"file-对象-filelist-对象-filereader-对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file-对象-filelist-对象-filereader-对象"}},[e._v("#")]),e._v(" File 对象，FileList 对象，FileReader 对象")]),e._v(" "),s("h2",{attrs:{id:"file-对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file-对象"}},[e._v("#")]),e._v(" File 对象")]),e._v(" "),s("p",[e._v("File 对象代表一个文件，用来读写文件信息。它继承了 Blob 对象，或者说是一种特殊的 Blob 对象，所有可以使用 Blob 对象的场合都可以使用它。")]),e._v(" "),s("p",[e._v("最常见的使用场合是表单的文件上传控件（"),s("code",[e._v('<input type="file">')]),e._v("），用户选中文件以后，浏览器就会生成一个数组，里面是每一个用户选中的文件，它们都是 File 实例对象。")]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('// HTML 代码如下\n// <input id="fileItem" type="file">\nvar file = document.getElementById(\'fileItem\').files[0];\nfile instanceof File // true\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("上面代码中，file是用户选中的第一个文件，它是 File 的实例。")]),e._v(" "),s("h3",{attrs:{id:"_1-构造函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-构造函数"}},[e._v("#")]),e._v(" 1. 构造函数")]),e._v(" "),s("p",[e._v("浏览器原生提供一个File()构造函数，用来生成 File 实例对象。")]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("new File(array, name [, options])\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("File()构造函数接受三个参数。")]),e._v(" "),s("ul",[s("li",[e._v("array：一个数组，成员可以是二进制对象或字符串，表示文件的内容。")]),e._v(" "),s("li",[e._v("name：字符串，表示文件名或文件路径。")]),e._v(" "),s("li",[e._v("options：配置对象，设置实例的属性。该参数可选。")])]),e._v(" "),s("p",[e._v("第三个参数配置对象，可以设置两个属性。")]),e._v(" "),s("ul",[s("li",[e._v("type：字符串，表示实例对象的 MIME 类型，默认值为空字符串。")]),e._v(" "),s("li",[e._v("lastModified：时间戳，表示上次修改的时间，默认为Date.now()。")])]),e._v(" "),s("p",[e._v("下面是一个例子。")]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("var file = new File(\n  ['foo'],\n  'foo.txt',\n  {\n    type: 'text/plain',\n  }\n);\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("h3",{attrs:{id:"_2-实例属性和实例方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-实例属性和实例方法"}},[e._v("#")]),e._v(" 2. 实例属性和实例方法")]),e._v(" "),s("p",[e._v("File 对象有以下实例属性。")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("File.lastModified")]),e._v("：最后修改时间")]),e._v(" "),s("li",[s("code",[e._v("File.name")]),e._v("：文件名或文件路径")]),e._v(" "),s("li",[s("code",[e._v("File.size")]),e._v("：文件大小（单位字节）")]),e._v(" "),s("li",[s("code",[e._v("File.type")]),e._v("：文件的 MIME 类型")])]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('var myFile = new File([], \'file.bin\', {\n  lastModified: new Date(2018, 1, 1),\n});\nmyFile.lastModified // 1517414400000\nmyFile.name // "file.bin"\nmyFile.size // 0\nmyFile.type // ""\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("上面代码中，由于myFile的内容为空，也没有设置 MIME 类型，所以size属性等于0，type属性等于空字符串。")]),e._v(" "),s("p",[e._v("File 对象没有自己的实例方法，由于继承了 Blob 对象，因此可以使用 Blob 的实例方法slice()。")]),e._v(" "),s("h2",{attrs:{id:"filelist-对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#filelist-对象"}},[e._v("#")]),e._v(" FileList 对象")]),e._v(" "),s("p",[e._v("FileList对象是一个类似数组的对象，代表一组选中的文件，每个成员都是一个 File 实例。它主要出现在两个场合。")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("文件控件节点（"),s("code",[e._v('<input type="file">')]),e._v("）的files属性，返回一个 FileList 实例。")])]),e._v(" "),s("li",[s("p",[e._v("拖拉一组文件时，目标区的"),s("code",[e._v("DataTransfer.files")]),e._v("属性，返回一个 FileList 实例。")])])]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('// HTML 代码如下\n// <input id="fileItem" type="file">\nvar files = document.getElementById(\'fileItem\').files;\nfiles instanceof FileList // true\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("上面代码中，文件控件的files属性是一个 FileList 实例。")]),e._v(" "),s("p",[e._v("FileList 的实例属性主要是length，表示包含多少个文件。")]),e._v(" "),s("p",[e._v("FileList 的实例方法主要是item()，用来返回指定位置的实例。它接受一个整数作为参数，表示位置的序号（从零开始）。但是，由于 FileList 的实例是一个类似数组的对象，可以直接用方括号运算符，即myFileList[0]等同于myFileList.item(0)，所以一般用不到item()方法。")]),e._v(" "),s("h2",{attrs:{id:"filereader-对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#filereader-对象"}},[e._v("#")]),e._v(" FileReader 对象")]),e._v(" "),s("p",[e._v("FileReader 对象用于读取 File 对象或 Blob 对象所包含的文件内容。")]),e._v(" "),s("p",[e._v("浏览器原生提供一个FileReader构造函数，用来生成 FileReader 实例。")]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("var reader = new FileReader();\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("FileReader 有以下的实例属性。")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("FileReader.error：读取文件时产生的错误对象")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.readyState：整数，表示读取文件时的当前状态。一共有三种可能的状态，0表示尚未加载任何数据，1表示数据正在加载，2表示加载完成。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.result：读取完成后的文件内容，有可能是字符串，也可能是一个 ArrayBuffer 实例。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.onabort：abort事件（用户终止读取操作）的监听函数。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.onerror：error事件（读取错误）的监听函数。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.onload：load事件（读取操作完成）的监听函数，通常在这个函数里面使用result属性，拿到文件内容。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.onloadstart：loadstart事件（读取操作开始）的监听函数。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.onloadend：loadend事件（读取操作结束）的监听函数。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.onprogress：progress事件（读取操作进行中）的监听函数。")])])]),e._v(" "),s("p",[e._v("下面是监听load事件的一个例子。")]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('// HTML 代码如下\n// <input type="file" onchange="onChange(event)">\n\nfunction onChange(event) {\n  var file = event.target.files[0];\n  var reader = new FileReader();\n  reader.onload = function (event) {\n    console.log(event.target.result)\n  };\n\n  reader.readAsText(file);\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br")])]),s("p",[e._v("上面代码中，每当文件控件发生变化，就尝试读取第一个文件。如果读取成功（load事件发生），就打印出文件内容。")]),e._v(" "),s("p",[e._v("FileReader 有以下实例方法。")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("FileReader.abort()：终止读取操作，readyState属性将变成2。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.readAsArrayBuffer()：以 ArrayBuffer 的格式读取文件，读取完成后result属性将返回一个 ArrayBuffer 实例。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.readAsBinaryString()：读取完成后，result属性将返回原始的二进制字符串。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.readAsDataURL()：读取完成后，result属性将返回一个 Data URL 格式（Base64 编码）的字符串，代表文件内容。对于图片文件，这个字符串可以用于"),s("code",[e._v("<img>")]),e._v("元素的src属性。注意，这个字符串不能直接进行 Base64 解码，必须把前缀data:"),s("em",[e._v("/")]),e._v(";base64,从字符串里删除以后，再进行解码。")])]),e._v(" "),s("li",[s("p",[e._v("FileReader.readAsText()：读取完成后，result属性将返回文件内容的文本字符串。该方法的第一个参数是代表文件的 Blob 实例，第二个参数是可选的，表示文本编码，默认为 UTF-8。")])])]),e._v(" "),s("p",[e._v("下面是一个例子。")]),e._v(" "),s("div",{staticClass:"language-file line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('/* HTML 代码如下\n  <input type="file" onchange="previewFile()">\n  <img src="" height="200">\n*/\n\nfunction previewFile() {\n  var preview = document.querySelector(\'img\');\n  var file    = document.querySelector(\'input[type=file]\').files[0];\n  var reader  = new FileReader();\n\n  reader.addEventListener(\'load\', function () {\n    preview.src = reader.result;\n  }, false);\n\n  if (file) {\n    reader.readAsDataURL(file);\n  }\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br")])]),s("p",[e._v("上面代码中，用户选中图片文件以后，脚本会自动读取文件内容，然后作为一个 Data URL 赋值给"),s("code",[e._v("<img>")]),e._v("元素的src属性，从而把图片展示出来。")])])}),[],!1,null,null,null);a.default=l.exports}}]);