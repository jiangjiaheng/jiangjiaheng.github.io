(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{459:function(s,a,n){"use strict";n.r(a);var e=n(17),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"表单-formdata-对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#表单-formdata-对象"}},[s._v("#")]),s._v(" 表单，FormData 对象")]),s._v(" "),n("h2",{attrs:{id:"表单概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#表单概述"}},[s._v("#")]),s._v(" 表单概述")]),s._v(" "),n("p",[s._v("表单（"),n("code",[s._v("<form>")]),s._v("）用来收集用户提交的数据，发送到服务器。比如，用户提交用户名和密码，让服务器验证，就要通过表单。表单提供多种控件，让开发者使用，具体的控件种类和用法请参考 HTML 语言的教程。本章主要介绍 JavaScript 与表单的交互。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form action="/handling-page" method="post">\n  <div>\n    <label for="name">用户名：</label>\n    <input type="text" id="name" name="user_name" />\n  </div>\n  <div>\n    <label for="passwd">密码：</label>\n    <input type="password" id="passwd" name="user_passwd" />\n  </div>\n  <div>\n    <input type="submit" id="submit" name="submit_button" value="提交" />\n  </div>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("上面代码就是一个简单的表单，包含三个控件：用户名输入框、密码输入框和提交按钮。")]),s._v(" "),n("p",[s._v("用户点击“提交”按钮，每一个控件都会生成一个键值对，键名是控件的name属性，键值是控件的value属性，键名和键值之间由等号连接。比如，用户名输入框的name属性是user_name，value属性是用户输入的值，假定是“张三”，提交到服务器的时候，就会生成一个键值对user_name=张三。")]),s._v(" "),n("p",[s._v("所有的键值对都会提交到服务器。但是，提交的数据格式跟"),n("code",[s._v("<form>")]),s._v("元素的method属性有关。该属性指定了提交数据的 HTTP 方法。如果是 GET 方法，所有键值对会以 URL 的查询字符串形式，提交到服务器，比如"),n("code",[s._v("/handling-page?user_name=张三&user_passwd=123&submit_button=提交")]),s._v("。下面就是 GET 请求的 HTTP 头信息。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("GET /handling-page?user_name=张三&user_passwd=123&submit_button=提交\nHost: example.com\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("如果是 POST 方法，所有键值对会连接成一行，作为 HTTP 请求的数据体发送到服务器，比如"),n("code",[s._v("user_name=张三&user_passwd=123&submit_button=提交")]),s._v("。下面就是 POST 请求的头信息。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("POST /handling-page HTTP/1.1\nHost: example.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 74\n\nuser_name=张三&user_passwd=123&submit_button=提交\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("注意，实际提交的时候，只要键值不是 URL 的合法字符（比如汉字“张三”和“提交”），浏览器会自动对其进行编码。")]),s._v(" "),n("p",[s._v("点击submit控件，就可以提交表单。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form>\n  <input type="submit" value="提交">\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("上面表单就包含一个submit控件，点击这个控件，浏览器就会把表单数据向服务器提交。")]),s._v(" "),n("p",[s._v("注意，表单里面的"),n("code",[s._v("<button>")]),s._v("元素如果没有用type属性指定类型，那么默认就是submit控件。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<form>\n  <button>提交</button>\n</form>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("上面表单的"),n("code",[s._v("<button>")]),s._v("元素，点击以后也会提交表单。")]),s._v(" "),n("p",[s._v("除了点击submit控件提交表单，还可以用表单元素的submit()方法，通过脚本提交表单。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("formElement.submit();\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("表单元素的reset()方法可以重置所有控件的值（重置为默认值）。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("formElement.reset()\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"formdata-对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#formdata-对象"}},[s._v("#")]),s._v(" FormData 对象")]),s._v(" "),n("h3",{attrs:{id:"_1-概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[s._v("#")]),s._v(" 1. 概述")]),s._v(" "),n("p",[s._v("表单数据以键值对的形式向服务器发送，这个过程是浏览器自动完成的。但是有时候，我们希望通过脚本完成过程，构造和编辑表单键值对，然后通过XMLHttpRequest.send()方法发送。浏览器原生提供了 FormData 对象来完成这项工作。")]),s._v(" "),n("p",[s._v("FormData 首先是一个构造函数，用来生成实例。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var formdata = new FormData(form);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("FormData()构造函数的参数是一个表单元素，这个参数是可选的。如果省略参数，就表示一个空的表单，否则就会处理表单元素里面的键值对。")]),s._v(" "),n("p",[s._v("下面是一个表单。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form id="myForm" name="myForm">\n  <div>\n    <label for="username">用户名：</label>\n    <input type="text" id="username" name="username">\n  </div>\n  <div>\n    <label for="useracc">账号：</label>\n    <input type="text" id="useracc" name="useracc">\n  </div>\n  <div>\n    <label for="userfile">上传文件：</label>\n    <input type="file" id="userfile" name="userfile">\n  </div>\n<input type="submit" value="Submit!">\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("我们用 FormData 对象处理上面这个表单。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var myForm = document.getElementById('myForm');\nvar formData = new FormData(myForm);\n\n// 获取某个控件的值\nformData.get('username') // \"\"\n\n// 设置某个控件的值\nformData.set('username', '张三');\n\nformData.get('username') // \"张三\"\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"_2-实例方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-实例方法"}},[s._v("#")]),s._v(" 2. 实例方法")]),s._v(" "),n("p",[s._v("FormData 提供以下实例方法。")]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("FormData.get(key)")]),s._v("：获取指定键名对应的键值，参数为键名。如果有多个同名的键值对，则返回第一个键值对的键值。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.getAll(key)")]),s._v("：返回一个数组，表示指定键名对应的所有键值。如果有多个同名的键值对，数组会包含所有的键值。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.set(key, value)")]),s._v("：设置指定键名的键值，参数为键名。如果键名不存在，会添加这个键值对，否则会更新指定键名的键值。如果第二个参数是文件，还可以使用第三个参数，表示文件名。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.delete(key)")]),s._v("：删除一个键值对，参数为键名。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.append(key, value)")]),s._v("：添加一个键值对。如果键名重复，则会生成两个相同键名的键值对。如果第二个参数是文件，还可以使用第三个参数，表示文件名。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.has(key)")]),s._v("：返回一个布尔值，表示是否具有该键名的键值对。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.keys()")]),s._v("：返回一个遍历器对象，用于for...of循环遍历所有的键名。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.values()")]),s._v("：返回一个遍历器对象，用于for...of循环遍历所有的键值。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("FormData.entries()")]),s._v("：返回一个遍历器对象，用于for...of循环遍历所有的键值对。如果直接用for...of循环遍历 FormData 实例，默认就会调用这个方法。")])])]),s._v(" "),n("p",[s._v("下面是get()、getAll()、set()、append()方法的例子。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var formData = new FormData();\n\nformData.set('username', '张三');\nformData.append('username', '李四');\nformData.get('username') // \"张三\"\nformData.getAll('username') // [\"张三\", \"李四\"]\n\nformData.append('userpic[]', myFileInput.files[0], 'user1.jpg');\nformData.append('userpic[]', myFileInput.files[1], 'user2.jpg');\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("下面是遍历器的例子。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var formData = new FormData();\nformData.append('key1', 'value1');\nformData.append('key2', 'value2');\n\nfor (var key of formData.keys()) {\n  console.log(key);\n}\n// \"key1\"\n// \"key2\"\n\nfor (var value of formData.values()) {\n  console.log(value);\n}\n// \"value1\"\n// \"value2\"\n\nfor (var pair of formData.entries()) {\n  console.log(pair[0] + ': ' + pair[1]);\n}\n// key1: value1\n// key2: value2\n\n// 等同于遍历 formData.entries()\nfor (var pair of formData) {\n  console.log(pair[0] + ': ' + pair[1]);\n}\n// key1: value1\n// key2: value2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("h2",{attrs:{id:"表单的内置验证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#表单的内置验证"}},[s._v("#")]),s._v(" 表单的内置验证")]),s._v(" "),n("h3",{attrs:{id:"_1-自动校验"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-自动校验"}},[s._v("#")]),s._v(" 1. 自动校验")]),s._v(" "),n("p",[s._v("表单提交的时候，浏览器允许开发者指定一些条件，它会自动验证各个表单控件的值是否符合条件。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 必填 --\x3e\n<input required>\n\n\x3c!-- 必须符合正则表达式 --\x3e\n<input pattern="banana|cherry">\n\n\x3c!-- 字符串长度必须为6个字符 --\x3e\n<input minlength="6" maxlength="6">\n\n\x3c!-- 数值必须在1到10之间 --\x3e\n<input type="number" min="1" max="10">\n\n\x3c!-- 必须填入 Email 地址 --\x3e\n<input type="email">\n\n\x3c!-- 必须填入 URL --\x3e\n<input type="URL">\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[s._v("如果一个控件通过验证，它就会匹配:valid的 CSS 伪类，浏览器会继续进行表单提交的流程。如果没有通过验证，该控件就会匹配:invalid的 CSS 伪类，浏览器会终止表单提交，并显示一个错误信息。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("input:invalid {\n  border-color: red;\n}\ninput,\ninput:valid {\n  border-color: #ccc;\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"_3-checkvalidity"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-checkvalidity"}},[s._v("#")]),s._v(" 3. checkValidity()")]),s._v(" "),n("p",[s._v("除了提交表单的时候，浏览器自动校验表单，还可以手动触发表单的校验。表单元素和表单控件都有checkValidity()方法，用于手动触发校验。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 触发整个表单的校验\nform.checkValidity()\n\n// 触发单个表单控件的校验\nformControl.checkValidity()\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("checkValidity()方法返回一个布尔值，true表示通过校验，false表示没有通过校验。因此，提交表单可以封装为下面的函数。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("function submitForm(action) {\n  var form = document.getElementById('form');\n  form.action = action;\n  if (form.checkValidity()) {\n    form.submit();\n  }\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"_3-willvalidate-属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-willvalidate-属性"}},[s._v("#")]),s._v(" 3. willValidate 属性")]),s._v(" "),n("p",[s._v("控件元素的willValidate属性是一个布尔值，表示该控件是否会在提交时进行校验。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// HTML 代码如下\n// <form novalidate>\n//   <input id="name" name="name" required />\n// </form>\n\nvar input = document.querySelector(\'#name\');\ninput.willValidate // true\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"_4-validationmessage-属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-validationmessage-属性"}},[s._v("#")]),s._v(" 4. validationMessage 属性")]),s._v(" "),n("p",[s._v("控件元素的validationMessage属性返回一个字符串，表示控件不满足校验条件时，浏览器显示的提示文本。以下两种情况，该属性返回空字符串。")]),s._v(" "),n("ul",[n("li",[s._v("该控件不会在提交时自动校验")]),s._v(" "),n("li",[s._v("该控件满足校验条件")])]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// HTML 代码如下\n// <form><input type="text" required></form>\ndocument.querySelector(\'form input\').validationMessage\n// "请填写此字段。"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("下面是另一个例子。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var myInput = document.getElementById('myinput');\nif (!myInput.checkValidity()) {\n  document.getElementById('prompt').innerHTML = myInput.validationMessage;\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"_5-setcustomvalidity"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-setcustomvalidity"}},[s._v("#")]),s._v(" 5. setCustomValidity()")]),s._v(" "),n("p",[s._v("控件元素的setCustomValidity()方法用来定制校验失败时的报错信息。它接受一个字符串作为参数，该字符串就是定制的报错信息。如果参数为空字符串，则上次设置的报错信息被清除。")]),s._v(" "),n("p",[s._v("这个方法可以替换浏览器内置的表单验证报错信息，参数就是要显示的报错信息。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form action="somefile.php">\n  <input\n    type="text"\n    name="username"\n    placeholder="Username"\n    pattern="[a-z]{1,15}"\n    id="username"\n  >\n  <input type="submit">\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("上面的表单输入框，要求只能输入小写字母，且不得超过15个字符。如果输入不符合要求（比如输入“ABC”），提交表单的时候，Chrome 浏览器会弹出报错信息“Please match the requested format.”，禁止表单提交。下面使用setCustomValidity()方法替换掉报错信息。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var input = document.getElementById('username');\ninput.oninvalid = function (event) {\n  event.target.setCustomValidity(\n    '用户名必须是小写字母，不能为空，最长不超过15个字符'\n  );\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("上面代码中，setCustomValidity()方法是在invalid事件的监听函数里面调用。该方法也可以直接调用，这时如果参数不为空字符串，浏览器就会认为该控件没有通过校验，就会立刻显示该方法设置的报错信息。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/* HTML 代码如下\n<form>\n  <p><input type=\"file\" id=\"fs\"></p>\n  <p><input type=\"submit\"></p>\n</form>\n*/\n\ndocument.getElementById('fs').onchange = checkFileSize;\n\nfunction checkFileSize() {\n  var fs = document.getElementById('fs');\n  var files = fs.files;\n  if (files.length > 0) {\n     if (files[0].size > 75 * 1024) {\n       fs.setCustomValidity('文件不能大于 75KB');\n       return;\n     }\n  }\n  fs.setCustomValidity('');\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("上面代码一旦发现文件大于 75KB，就会设置校验失败，同时给出自定义的报错信息。然后，点击提交按钮时，就会显示报错信息。这种校验失败是不会自动消除的，所以如果所有文件都符合条件，要将报错信息设为空字符串，手动消除校验失败的状态。")]),s._v(" "),n("h3",{attrs:{id:"_6-validity-属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-validity-属性"}},[s._v("#")]),s._v(" 6. validity 属性")]),s._v(" "),n("p",[s._v("控件元素的属性validity属性返回一个ValidityState对象，包含当前校验状态的信息。")]),s._v(" "),n("p",[s._v("该对象有以下属性，全部为只读属性。")]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("ValidityState.badInput")]),s._v("：布尔值，表示浏览器是否不能将用户的输入转换成正确的类型，比如用户在数值框里面输入字符串。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.customError")]),s._v("：布尔值，表示是否已经调用\n"),n("code",[s._v("setCustomValidity()")]),s._v("方法，将校验信息设置为一个非空字符串。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.patternMismatch")]),s._v("：布尔值，表示用户输入的值是否不满足模式的要求。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.rangeOverflow")]),s._v("：布尔值，表示用户输入的值是否大于最大范围。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.rangeUnderflow")]),s._v("：布尔值，表示用户输入的值是否小于最小范围。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.stepMismatch")]),s._v("：布尔值，表示用户输入的值不符合步长的设置（即不能被步长值整除）。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.tooLong")]),s._v("：布尔值，表示用户输入的字数超出了最长字数。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.tooShort")]),s._v("：布尔值，表示用户输入的字符少于最短字数。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.typeMismatch")]),s._v("：布尔值，表示用户填入的值不符合类型要求（主要是类型为 Email 或 URL 的情况）。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.valid")]),s._v("：布尔值，表示用户是否满足所有校验条件。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("ValidityState.valueMissing")]),s._v("：布尔值，表示用户没有填入必填的值。")])])]),s._v(" "),n("p",[s._v("下面是一个例子。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var input = document.getElementById('myinput');\nif (input.validity.valid) {\n  console.log('通过校验');\n} else {\n  console.log('校验失败');\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("下面是另外一个例子。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var txt = '';\nif (document.getElementById('myInput').validity.rangeOverflow) {\n  txt = '数值超过上限';\n}\ndocument.getElementById('prompt').innerHTML = txt;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("如果想禁止浏览器弹出表单验证的报错信息，可以监听invalid事件。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var input = document.getElementById('username');\nvar form  = document.getElementById('form');\n\nvar elem = document.createElement('div');\nelem.id  = 'notify';\nelem.style.display = 'none';\nform.appendChild(elem);\n\ninput.addEventListener('invalid', function (event) {\n  event.preventDefault();\n  if (!event.target.validity.valid) {\n    elem.textContent   = '用户名必须是小写字母';\n    elem.className     = 'error';\n    elem.style.display = 'block';\n    input.className    = 'invalid animated shake';\n  }\n});\n\ninput.addEventListener('input', function(event){\n  if ( 'block' === elem.style.display ) {\n    input.className = '';\n    elem.style.display = 'none';\n  }\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("p",[s._v("上面代码中，一旦发生invalid事件（表单验证失败），event.preventDefault()用来禁止浏览器弹出默认的验证失败提示，然后设置定制的报错提示框。")]),s._v(" "),n("h3",{attrs:{id:"_7-表单的-novalidate-属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-表单的-novalidate-属性"}},[s._v("#")]),s._v(" 7. 表单的 novalidate 属性")]),s._v(" "),n("p",[s._v("表单元素的 HTML 属性novalidate，可以关闭浏览器的自动校验。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<form novalidate>\n</form>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("这个属性也可以在脚本里设置。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("form.noValidate = true;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("如果表单元素没有设置novalidate属性，那么提交按钮（"),n("code",[s._v("<button>")]),s._v("或"),n("code",[s._v("<input>")]),s._v("元素）的formnovalidate属性也有同样的作用。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form>\n  <input type="submit" value="submit" formnovalidate>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"enctype-属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#enctype-属性"}},[s._v("#")]),s._v(" enctype 属性")]),s._v(" "),n("p",[s._v("表单能够用四种编码，向服务器发送数据。编码格式由表单的enctype属性决定。")]),s._v(" "),n("p",[s._v("假定表单有两个字段，分别是foo和baz，其中foo字段的值等于bar，baz字段的值是一个分为两行的字符串。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("The first line.\nThe second line.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("下面四种格式，都可以将这个表单发送到服务器。")]),s._v(" "),n("h3",{attrs:{id:"_1-get-方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-get-方法"}},[s._v("#")]),s._v(" （1）GET 方法")]),s._v(" "),n("p",[s._v("如果表单使用GET方法发送数据，enctype属性无效。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form\n  action="register.php"\n  method="get"\n  onsubmit="AJAXSubmit(this); return false;"\n>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("数据将以 URL 的查询字符串发出。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("?foo=bar&baz=The%20first%20line.%0AThe%20second%20line.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_2-application-x-www-form-urlencoded"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-application-x-www-form-urlencoded"}},[s._v("#")]),s._v(" （2）application/x-www-form-urlencoded")]),s._v(" "),n("p",[s._v("如果表单用POST方法发送数据，并省略enctype属性，那么数据以application/x-www-form-urlencoded格式发送（因为这是默认值）。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form\n  action="register.php"\n  method="post"\n  onsubmit="AJAXSubmit(this); return false;"\n>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("发送的 HTTP 请求如下。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Content-Type: application/x-www-form-urlencoded\n\nfoo=bar&baz=The+first+line.%0D%0AThe+second+line.%0D%0A\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("上面代码中，数据体里面的%0D%0A代表换行符（\\r\\n）。")]),s._v(" "),n("h3",{attrs:{id:"_3-text-plain"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-text-plain"}},[s._v("#")]),s._v(" （3）text/plain")]),s._v(" "),n("p",[s._v("如果表单使用POST方法发送数据，enctype属性为text/plain，那么数据将以纯文本格式发送。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form\n  action="register.php"\n  method="post"\n  enctype="text/plain"\n  onsubmit="AJAXSubmit(this); return false;"\n>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("发送的 HTTP 请求如下。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Content-Type: text/plain\n\nfoo=bar\nbaz=The first line.\nThe second line.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_4-multipart-form-data"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-multipart-form-data"}},[s._v("#")]),s._v(" （4）multipart/form-data")]),s._v(" "),n("p",[s._v("如果表单使用POST方法，enctype属性为multipart/form-data，那么数据将以混合的格式发送。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form\n  action="register.php"\n  method="post"\n  enctype="multipart/form-data"\n  onsubmit="AJAXSubmit(this); return false;"\n>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("发送的 HTTP 请求如下。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('Content-Type: multipart/form-data; boundary=---------------------------314911788813839\n\n-----------------------------314911788813839\nContent-Disposition: form-data; name="foo"\n\nbar\n-----------------------------314911788813839\nContent-Disposition: form-data; name="baz"\n\nThe first line.\nThe second line.\n\n-----------------------------314911788813839--\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("这种格式也是文件上传的格式。")]),s._v(" "),n("h2",{attrs:{id:"文件上传"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文件上传"}},[s._v("#")]),s._v(" 文件上传")]),s._v(" "),n("p",[s._v("用户上传文件，也是通过表单。具体来说，就是通过文件输入框选择本地文件，提交表单的时候，浏览器就会把这个文件发送到服务器。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<input type="file" id="file" name="myFile">\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("此外，还需要将表单"),n("code",[s._v("<form>")]),s._v("元素的method属性设为POST，enctype属性设为multipart/form-data。其中，enctype属性决定了 HTTP 头信息的Content-Type字段的值，默认情况下这个字段的值是application/x-www-form-urlencoded，但是文件上传的时候要改成multipart/form-data。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<form method="post" enctype="multipart/form-data">\n  <div>\n    <label for="file">选择一个文件</label>\n    <input type="file" id="file" name="myFile" multiple>\n  </div>\n  <div>\n    <input type="submit" id="submit" name="submit_button" value="上传" />\n  </div>\n</form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("上面的 HTML 代码中，file 控件的multiple属性，指定可以一次选择多个文件；如果没有这个属性，则一次只能选择一个文件。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var fileSelect = document.getElementById('file');\nvar files = fileSelect.files;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("然后，新建一个 FormData 实例对象，模拟发送到服务器的表单数据，把选中的文件添加到这个对象上面。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var formData = new FormData();\n\nfor (var i = 0; i < files.length; i++) {\n  var file = files[i];\n\n  // 只上传图片文件\n  if (!file.type.match('image.*')) {\n    continue;\n  }\n\n  formData.append('photos[]', file, file.name);\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("最后，使用 Ajax 向服务器上传文件。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var xhr = new XMLHttpRequest();\n\nxhr.open('POST', 'handler.php', true);\n\nxhr.onload = function () {\n  if (xhr.status !== 200) {\n    console.log('An error occurred!');\n  }\n};\n\nxhr.send(formData);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("除了发送 FormData 实例，也可以直接 AJAX 发送文件。")]),s._v(" "),n("div",{staticClass:"language-form line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var file = document.getElementById('test-input').files[0];\nvar xhr = new XMLHttpRequest();\n\nxhr.open('POST', 'myserver/uploads');\nxhr.setRequestHeader('Content-Type', file.type);\nxhr.send(file);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);